# Cache Configuration for AgentOS Context Optimization

cache_config:
  version: "1.0"
  
  # Cache Storage Configuration
  storage:
    base_path: "~/.config/opencode/cache"
    structure:
      standards: "standards/"
      products: "products/"
      specs: "specs/"
      context: "context/"
      agents: "agents/"
    
    # File Management
    file_management:
      naming_convention: "{layer}_{hash}_{timestamp}.cache"
      compression: "gzip"
      encryption: false
      backup_enabled: true
      backup_interval: "24h"
  
  # Cache Policies
  policies:
    # Eviction Policies
    eviction:
      strategy: "lru"  # Least Recently Used
      max_entries: 1000
      size_threshold: "100MB"
      age_threshold: "7d"
    
    # Invalidation Policies
    invalidation:
      on_file_change: true
      on_config_change: true
      on_version_change: true
      manual_triggers: ["cache:clear", "cache:refresh"]
    
    # Preloading Policies
    preloading:
      enabled: true
      patterns:
        - "bmad/methodology-lite"
        - "coding/style-guides"
        - "security/secure-coding"
      schedule: "startup"
      background_refresh: true
  
  # Performance Optimization
  performance:
    # Compression Settings
    compression:
      algorithm: "gzip"
      level: 6
      threshold: "1KB"
    
    # Parallel Processing
    parallel:
      enabled: true
      max_workers: 4
      batch_size: 10
    
    # Memory Management
    memory:
      max_memory_usage: "50MB"
      gc_threshold: "80%"
      memory_mapping: true
  
  # Monitoring and Analytics
  monitoring:
    enabled: true
    metrics:
      - "hit_rate"
      - "miss_rate"
      - "load_time"
      - "size_efficiency"
      - "compression_ratio"
    
    logging:
      level: "info"
      file: "~/.config/opencode/logs/cache.log"
      rotation: "daily"
    
    alerts:
      low_hit_rate: 70  # Alert if hit rate below 70%
      high_memory_usage: 80  # Alert if memory usage above 80%
      slow_loading: 5000  # Alert if loading takes more than 5 seconds
  
  # Error Handling
  error_handling:
    fallback_strategy: "load_from_source"
    retry_attempts: 3
    retry_delay: "1s"
    graceful_degradation: true
    
    # Recovery Mechanisms
    recovery:
      auto_repair: true
      corruption_detection: true
      backup_restoration: true